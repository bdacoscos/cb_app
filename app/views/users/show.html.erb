<div class="container">
  <div class="row">

    <div class="col s4">
      <div class="col s12">
        <h2><%= current_user.name %></h2>
      </div>
      <div class="col s12">
        <p><%= current_user.location %></p>
      </div>
      <div class="col s12">
        <%= image_tag current_user.image.url(:medium) %>
      </div>
      <div class="col s12">
        <h5>Recipe &hearts;'s</h5>
      </div>
      <div class="col s12">
        <span>&hearts;</span>
      </div>
    </div>

    <div class="col s8">
      <div class="col s12">
        <h3>Your Recipes</h3>
        <%= link_to "View All", recipes_path %>
        &nbsp;&nbsp;|&nbsp;&nbsp;
        <%= link_to "Add New Recipe", new_recipe_path %>
      </div>
      <div class="col s12">
        <% if current_user.recipes.any? %>
          <% shuffled_recipes = current_user.recipes.all.shuffle %>
          <% if shuffled_recipes.count > 3 %>
            <% random_recipes = shuffled_recipes[0 .. 2] %>
            <% random_recipes.each do |recipe| %>
              <div class="card small col s4">
                <div class="card-image max-width">
                  <%= image_tag recipe.image.url %>
                  <span class="card-title"><%= recipe.name %></span>
                </div>
                <div class="card-action">
                  <%= link_to recipe.name, recipe_path(recipe) %>
                </div>
              </div>
            <% end %>
          <% else %>
            <% shuffled_recipes.each do |recipe| %>
              <div class="card small col s4">
                <div class="card-image max-width">
                  <%= image_tag recipe.image.url %>
                  <span class="card-title"><%= recipe.name %></span>
                </div>
                <div class="card-action">
                  <%= link_to recipe.name, recipe_path(recipe) %>
                </div>
              </div>
            <% end %>
          <% end %>
        <% else %>
          <p>You have no recipes yet!</p>
        <% end %>
      </div>
      <div class="col s12">
        <h3>Your Top 3 Recipes</h3>
      </div>
      <div class="col s12">
        <% if current_user.recipes.any? %>
          <% if @user_recipes.length > 3 %>
            <% top_three = @user_recipes[0 .. 2] %>
            <% top_three.each do |recipe| %>
              <div class="card small col s4">
                <div class="card-image max-width">
                  <%= image_tag recipe.image.url %>
                  <span class="card-title"><%= recipe.name %></span>
                </div>
                <div class="card-action">
                  <%= link_to recipe.name, recipe_path(recipe) %>
                </div>
              </div>
            <% end %>
          <% else %>
            <% @user_recipes.each do |recipe| %>
              <div class="card small col s4">
                <div class="card-image max-width">
                  <%= image_tag recipe.image.url %>
                  <span class="card-title"><%= recipe.name %></span>
                </div>
                <div class="card-action">
                  <%= link_to recipe.name, recipe_path(recipe) %>
                </div>
              </div>
            <% end %>
          <% end %>
        <% else %>
          <p>Nothing here. Add some recipes!</p>
        <% end %>      
      </div>
        
    </div>

  </div>
</div>